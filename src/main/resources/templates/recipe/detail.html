<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<div id="main-wrapper">
		<div class="container">
			<div class="row">
				<table class="table">
				 <tr class="text-center">
				  <td colspan="3">
				   <img th:src="${vo.poster}" style="width: 750px;height: 450px;" onerror="this.src='/images/noimage.png'">
				  </td>
				 </tr>
				 <tr>
				  <td class="text-center" colspan="3"><h3>[[${vo.title}]]</h3></td>
				 </tr>
				 <tr>
				  <td class="text-center"><img src="/images/a1.png"></td>
				  <td class="text-center"><img src="/images/a2.png"></td>
				  <td class="text-center"><img src="/images/a3.png"></td>
				 </tr>
				 <tr>
				  <td class="text-center">[[${vo.info1}]]</td>
				  <td class="text-center">[[${vo.info2}]]</td>
				  <td class="text-center">[[${vo.info3}]]</td>
				 </tr>
				</table>
				<table class="table">
				 <tr>
				  <td colspan="2" class="text-center"><h4><b>[ì¡°ë¦¬ìˆœì„œ]</b></h4></td>
				 </tr>
				 <tr th:each="data,status:${mList}">
				  <td class="text-left" width="80%" style="font-size: 15px;color: black;">[[${data}]]</td>
				  <td class="text-right" width="20%">
				   <img th:src="${nList[status.index]}" style="width: 150px;height: 100px;" class="img-rounded">
				  </td>
				  <!-- 
				  		status
				  		status.index => ArrayListì˜ index
				  		status.count => ArrayListì˜ ì´ ê°¯ìˆ˜
				  		status.last => ArrayListì˜ ì €ì¥ëœ ë§ˆì§€ë§‰ ê°’
				  		status.first => ì²« ë²ˆì§¸ ê°’
				  		status.even => ì§ìˆ˜
				  		status.odd => í™€ìˆ˜
				  		
				  		=> StringTokenizer
				  		=> <c:forTokens>
				  		=> ${#strings.split(ë¬¸ìì—´,'êµ¬ë¶„ì'}
				   -->
				 </tr>
				</table>
				<table class="table">
				 <tr>
				  <td width="20%" class="text-center" rowspan="2">
				   <img th:src="${vo.chef_poster}" style="width: 120px;height: 120px;" class="img-circle">
				  </td>
				  <td width="80%">ì‰í”„ëª…: [[${vo.chef}]]</td>
				 </tr>
				 <tr>
				  <td width="80%">[[${vo.chef_profile}]]</td> 
				 </tr>
				</table>
			</div>
		<div class="row aln-center" style="margin-top: 0px;">
	  <table class="table">
	   <tr>
	    <td>
	     <table class="table" v-for="rvo in list">
	      <tr>
	       <td class="text-left" width="80%">
	        ğŸ¤¡((rvo.name))&nbsp;((rvo.dbday))
	       </td>
	       <td class="text-right" width="20%">
	       <span v-if="sessionId==rvo.id">
	        <button type="button" class="btn-xs btn-info upbtn" :id="'u'+rvo.no" @click="replyUpdateForm(rvo.no)">ìˆ˜ì •</button>
	        <button type="button" class="btn-xs btn-danger" @click="replyDelete(rvo.no)">ì‚­ì œ</button>
	        </span>
	       </td>
	      </tr>
	      <tr>
	       <td colspan="2" class="text-left">
	        <pre style="white-space: pre-wrap;background-color: white;border: none;">((rvo.msg))</pre>
	       </td>
	      </tr>
	      <tr>
	       <td colspan="2">
	        <table  class="table" style="display: none;" :id="'up'+rvo.no">
			    <tr>
			     <td>
			      <textarea rows="4" cols="130" style="float: left;margin-left: 30px;" :id="'umsg'+rvo.no">((rvo.msg))</textarea>
			      <button type="button" class="btn-info" style="width: 105px;height: 86px;float: left;" @click="replyUpdate(rvo.no)">ìˆ˜ì •í•˜ê¸°</button>
			     </td>
			    </tr>
		   </table>
	       </td>
	      </tr>
	     </table>
	    </td>
	   </tr> 
	  </table>
	   <table  th:if="${session.id!=null}">
	    <tr>
	     <td>
	      <textarea rows="4" cols="130" style="float: left;margin-left: 30px;" v-model="msg" ref="msg"></textarea>
	      <button type="button" class="btn-info" style="width: 105px;height: 86px;float: left;" @click="insert()">ëŒ“ê¸€ ì“°ê¸°</button>
	     </td>
	    </tr>
	   </table>
  	</div>
  </div>
</div>
<script>
 const commentApp=Vue.createApp({
	 // Model = ë°ì´í„° ê´€ë¦¬ => ë³€ìˆ˜ê°€ ë³€ê²½ì´ ë˜ë©´ => HTMLì— ì ìš©
	 data(){
		 return {
			 // ë©¤ë²„ë³€ìˆ˜
			 list:[],
			 cno:'[[${vo.no}]]',
			 sessionId:'[[${sessionId}]]',
			 msg:'',
			 type:2,
			 up:false
		 }
	 },
	 // VM => ë³€ìˆ˜ë¥¼ ë³€ê²½í•˜ëŠ” ê³³ 
	 /*
	 	callback : Vueì˜ ìƒëª…
	 	= created() : ì„¤ì • => Vueê°ì²´ ìƒì„± ì™„ë£Œ
	 	*** = mounted() : ë¸Œë¼ìš°ì œì—‡ HTMLì„ ë³€ì—­ í›„ ì¶œë ¥ ì™„ë£Œ
	 	= updated() : ë©¤ë²„ë³€ìˆ˜ê°€ ë³€ê²½ëœ ê²½ìš°
	 	= unmounted() : í™”ë©´ ë³€ê²½ => Vueê°ì²´ê°€ ì†Œë©¸
	 	
	 	ì‚¬ìš©ì ìš”ì²­ == VM ì‘ì—… == ê²°ê³¼ê°’ : Model == View(HTML)
	 	
	 	ê°€ìƒë” => ì¼ë¶€ë§Œ ê´€ë¦¬
	 	-------- ì„ì‹œ ë©”ëª¨ë¦¬ì— ì €ì¥ ====== ì‹¤ì œ ë”(ë¸Œë¼ìš°ì €ì—ì„œ ì½ì–´ì„œ ì¶œë ¥)
	 */
	 mounted(){
		 // ìë™ í˜¸ì¶œ
		 // jquery / react
		 /*
		 	$(function(){
		 		$('#a').click(function(){})
		 	})
		 	
		 	=> useEffect(()=>{
		 		axios.get()
		 	},[curpage])
		 	query([curpage])
		 	})
		 */
		 axios.get('http://localhost/comment/list_vue/',{
			 params:{
				 cno:this.cno,
				 type:this.type
			 }
		 }).then(response=>{
			 console.log(response.data)
			 this.list=response.data.list
			 this.cno=response.data.cno
			 this.type=response.data.type
		 })
	 },
	 methods:{
		 // ì‚¬ìš©ì ì •ì˜ ê¸°ëŠ¥ => ìš”ì²­ ì²˜ë¦¬
		 insert(){
			 if(this.msg==="")
		     {
				 this.$refs.msg.focus()
				 return
		     }
			 axios.post('http://localhost/comment/insert_vue/',{
				 cno:this.cno,
				 type:this.type,
				 msg:this.msg
			 }).then(response=>{
				 console.log(response.data)
				 this.list=response.data.list
				 this.cno=response.data.cno
				 this.type=response.data.type
		    })
		    this.msg=""
		    this.$refs.msg.focus()
		 },
		 replyDelete(no){
			 axios.get('http://localhost/comment/delete_vue/',{
				 params:{
					 no:no,
					 cno:this.cno,
					 type:this.type
				 }
			 }).then(response=>{
				 console.log(response.data)
				 this.list=response.data.list
				 this.cno=response.data.cno
				 this.type=response.data.type
		    })
		 },
		 replyUpdateForm(no){
			 $('.ups').hide()
			 $('.upbtn').text("ìˆ˜ì •")
			 if(this.up===false)
			 {
				 this.up=true
				 $('#up'+no).show()
				 $('#u'+no).text("ì·¨ì†Œ")
			 }
			 else
			 {
				 this.up=false
				 $('#up'+no).hide()
				 $('#u'+no).text("ìˆ˜ì •")
			 }
		 },
		 replyUpdate(no){
			let msg=$('#umsg'+no).val()
			if(msg==="")
			{
				$('#umsg'+no).focus()
				return
			}
			axios.get('http://localhost/comment/update_vue/',{
				params:{
					no:no,
					cno:this.cno,
					type:this.type,
					msg:msg
				}
			}).then(response=>{
				 console.log(response.data)
				 this.list=response.data.list
				 this.cno=response.data.cno
				 this.type=response.data.type
				 $('#up'+no).hide()
				 $('#u'+no).text("ìˆ˜ì •")
		    })
		 }
		 
	 },
	 computed:{
		 // ì‹œê°„, ê°€ê²©, ì´ê¸ˆì•¡ => Format
	 },
	 components:{
		 // ì—¬ëŸ¬ê°œì˜ ê¸°ëŠ¥ì„ ì²˜ë¦¬ => include
	 }
	 // HTMLì¶œë ¥í•˜ëŠ” ì˜ì—­ => <template> => View =. MVVM
 })
 commentApp.config.compilerOptions.delimiters=['((','))']
 commentApp.mount("#main-wrapper")
</script>			
</body>
</html>